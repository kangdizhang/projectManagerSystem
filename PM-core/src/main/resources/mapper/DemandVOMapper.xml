<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.ectrip.dao.DemandVODAO">

	<resultMap type="DemandVO" id="demandResultMap">
		<id column="ID" property="id"/>
		<result column="PROJECT_ID" property="projectId"/>
		<result column="PROJECT_NAME" property="projectName"/>
		<result column="DEMAND_NAME" property="demandName"/>
		<result column="DEMAND_DESCRIBE" property="demandDescribe"/>
		<result column="PUT_TIME" property="putTime"/>
		<result column="PUT_USERID" property="putUserId"/>
		<result column="VERSION" property="version"/>
		<result column="EXCEPT_END_TIME" property="exceptEndTime"/>
		<result column="ACTUAL_END_TIME" property="actualEndTime"/>
		<result column="COMPLETE_USERID" property="completeUserId"/>
		<result column="DEMAND_STATUS" property="demandStatus"/>
	</resultMap>

	<!--表名 -->
	<sql id="tableName">
		DEMAND
	</sql>

	<!-- 主键查询
	<select id="findDemand" resultMap="demandResultMap">
		SELECT <include refid="Field"></include> FROM <include refid="tableName"></include>
		WHERE ID=#{id}
	</select>-->

	<!-- 条件查询-->
	<select id="queryDemand" resultMap="demandResultMap">
		SELECT d.ID,DEMAND_NAME,DEMAND_DESCRIBE,PUT_TIME,PUT_USERID,VERSION,EXCEPT_END_TIME,ACTUAL_END_TIME,COMPLETE_USERID,
		(CASE WHEN DEMAND_STATUS='0' THEN '开发中'
		ELSE '已完成' END ) as DEMAND_STATUS,
        p.ID,p.PROJECT_NAME
		FROM DEMAND d,PROJECT p
		WHERE d.PROJECT_ID=p.ID AND d.PROJECT_ID=#{projectId}
		<if test="demandName!=null and demandName!=''">
			AND d.DEMAND_NAME=#{demandName}
		</if>
		<if test="demandStatus!=null and demandStatus!=''">
			AND d.DEMAND_STATUS=#{demandStatus}
		</if>
	</select>

	<!-- 修改
	<update id="updateVersion" parameterType="Version">
		UPDATE <include refid="tableName"></include>
		SET PROJECT_ID=#{projectId},MODLE_NAME=#{modleName},MODLE_DESCRIBE=#{modleDescribe},MODLE_STATE=#{modleState}
		WHERE ID=#{id}
	</update>-->

	<!-- 新增
	<insert id="saveModle" useGeneratedKeys="true" keyProperty="id">
		insert into <include refid="tableName"></include>(
			<include refid="Field"></include>
		) values (
			<include refid="FieldValue"></include>
		)
	</insert>-->

</mapper>